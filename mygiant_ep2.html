<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="bts_maintes.css">
    <link href="w31063.css" rel="stylesheet" type="text/css">
    <script src="tools/js/jquery.min.js"></script>
    <script src="tools/js/bootstrap.min.js"></script>
    <script src="tools/js/angular.min.js"></script>
    <title>Webteen - My Giant Nerd Boyfriend</title>
</head>
<body  ng-app="komentarApp" ng-controller="KomentarController">
    <div id="mainbody" >
        <div id="header" style="background: url(bg_new_bg.png);">
            <div class="header-link">
                <img src="logo/logo_trs3.png">
                <!-- mulai login komponen -->
                <span ng-if="loginDB == ''">
                    <button class="btn btn-primary btn-sm pull-right" data-target="#loginModal" data-toggle="modal" style="float: right;font-size:20px;">Login</button>
                </span>
                <span ng-if="loginDB != ''">
                    <button class="btn btn-primary btn-sm pull-right" ng-click="removeSession()" style="float: right;font-size:20px;">Log Out</button>
                    <p style="float: right;font-size:30px; font-family: alphabetizedct; font-weight: bolder;">Hi, {{loginDB}}</p>
                </span>
                    <div class="modal" data-backdrop="static" id="loginModal" tabindex="-1">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button class="close" data-dismiss="modal">&times;</button>
                                    <h4 class="modal-title">Login</h4>
                                    
                                </div>
                                <form name="formLogin" ng-submit="addSession()">
                                    <div class="modal-body">
                                            <div class="form-group">
                                                <label for="inputUserName">Name</label>
                                                <input type="text" class="form-control" ng-model="usernameText" placeholder="Input your name">
                                            </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button class="btn btn-primary" type="submit">Login</button>
                                        <button class="btn btn-primary" data-dismiss="modal" id="closeLogin" type="button">Close</button>
                                    </div>
                                </form>
                            </div>                      
                        </div>                  
                    </div>  
                <!-- Selesai login komponen  -->
            </div>
        </div>
        <div id="topnav">
                <ul>                    
                    <li><a href="mygiant_ep1.html" id="backarrow" title="previous page"><img class="arrow" src="icon/back-arrow.png"></a></li>
                    <li><a class="title-nav" href="mygiant.html" id="comic-title">My Giant Nerd Boyfriend</a></li>
                    <li><a href="mygiant_ep2.html" id="nextarrow" title="next page"><img class="arrow" src="icon/share.png"></a></li>
                </ul>
        </div>
        <div id="comic-pic" class="row container-fluid">
            <div class="col-md-12"  >
                <img  src="images/mgnb/mgnb_2pi.jpg">
            </div>
            <div class="col-md-12" >
                <img  src="images/mgnb/mgnb_2pii.jpg">
            </div>
            
        </div>
        <div class="container" style=" background-color: lightblue;"> 
             <section class="app-body"> 
                
                <ul class="unstyled"> 
                    <li ng-repeat="komentar in komentarDB track by $index">
                        <span ng-if="komentar.komikID == 'mygiant_ep2'">
                            <span style="color: blue; font-size: 50px; font-weight: bold;">{{ komentar.komentator }}</span><br/> <!-- ini komentator --> 
                            <span>{{ komentar.komentarIsi }}</span>  <!-- ini komentarnya -->
                        </span>
                    </li> 
                </ul>  
                <!-- <form name="komentarForm" ng-submit="addKomentar()" class="todo-form" ng-init="formInit()">
                    Name : <br>
                    <input type="text" ng-model="komentatorText" placeholder="Enter your Name"><br>
                    Comment : 
                    <input type="text" ng-model="komentarText" placeholder="Enter new comment" style="width: 500px; height: 80px" />
                    <input type="text" name="komikIDNya" id="komikIDNya" ng-model="komikIDText" style="display: none;"> 
                    <br />
                    <input type="submit" value="Send" style="margin-top: 40px;width: 100px;height: 50px;" /> 
                </form> -->
                <form name="komentarForm" ng-submit="addKomentar()" class="todo-form" ng-init="formInit()">
                    Name : <br>
                    <input type="text" ng-model="komentatorText" placeholder="Please Login First" value="{{loginDB}}" style="width: 100%; " title="Login tersedia di kanan atas"  disabled=""> <br>
                    Comment :
                    <input type="text" ng-model="komentarText" placeholder="Enter new comment" style="width: 100%; height: 80px" />
                    <input type="text" name="komikIDNya" id="komikIDNya" ng-model="komikIDText" style="display: none;"> 
                    <br />
                    <input type="submit" value="Send" style="margin-top: 25px;width: 100px;height: 50px; float: right" /> 
                </form>
                <section class="archive-control"> 
                    <!--  <span>{{ remaining() }} of {{ todos.length }} comments</span> -->
                    <!-- <p><input type="button"  ng-click="archive()" value="Delete" style="width: 100px;height: 50px;margin-top: -65px;float: right;margin-right: 35%"> </p>  -->
                </section>  
            </section> 

        </div> 
            <!-- <div id="footer">

                <div class="copyright">             
                    <p class="footer-company-name">Copyright &#169; 2018 Webteen Web Comic Inc. All right reserved</p>

                    <div class="footer-icons">
                        <a href="#"><img src="icon/002-twitter.png">Webteencomics</a>
                        <a href="#"><img src="icon/001-facebook.png">Webteencomics</a>
                        <a href="#"><img src="icon/envelope.png">help@webteen.in</a>
                    </div>
                </div>
            </div> -->
            <a id="back-to-top" href="#" class="btn btn-primary btn-lg back-to-top" role="button" title="Click to return on the top page" data-toggle="tooltip" data-placement="left"><span class="glyphicon glyphicon-chevron-up"></span></a>
            <div class="row" id="footer">
                <div class="copyright col-md-6 col-xs-12">              
                    <p class="footer-company-name">Copyright &#169; 2018 Webteen Web Comic Inc. All right reserved</p>
                </div>
                <div class="footer-icons col-md-6 col-xs-10">
                    <a href="#"><img src="icon/002-twitter.png">Webteencomics</a>
                    <a href="#"><img src="icon/001-facebook.png">Webteencomics</a>
                    <a href="#"><img src="icon/envelope.png">help@webteen.in</a>
                </div>
            </div>
    </div>

</body>
<script>
window.onscroll = function() {myFunction()};

var topnav = document.getElementById("topnav");
var sticky = topnav.offsetTop;

function myFunction() {
    if (window.pageYOffset >= sticky) {
    topnav.classList.add("sticky");
    } else {
    topnav.classList.remove("sticky");
    }
}
var app = angular.module('komentarApp', []);

app.controller('KomentarController',function($scope){
    


    // $scope.appTitle = "ToDo List "; 
    // $scope.appHeadline = "This will store in local storage!";   

    $scope.saved = localStorage.getItem('komentarDB'); 
    $scope.komentarDB = (localStorage.getItem('komentarDB')!==null) ? JSON.parse($scope.saved) : []; 
    localStorage.setItem('komentarDB', JSON.stringify($scope.komentarDB));  
    
    $scope.formInit = function() {
        console.log('masuk init');
        // $scope.komentarForm.$setDirty();
        // $scope.komikIDText = "mygiant_ep1";
        angular.forEach($scope.komentarForm, function(field) {
            console.log('masuk sini');
            // $scope.komentarForm.$setDirty();
        });
    }

    $scope.addKomentar = function() {
        if($scope.komentarText == "" || $scope.komentatorText == "" || $scope.komentarText == null || $scope.komentatorText == null){
            alert('Input KOmentar dan nama');
        }else{
            $scope.komikIDText = "mygiant_ep2";         
            $scope.komentarDB.push({             
                komentarIsi: $scope.komentarText,             
                komentator: $scope.komentatorText,
                komikID: $scope.komikIDText,
            }); 
            $scope.komentarText = '';  
            localStorage.setItem('komentarDB', JSON.stringify($scope.komentarDB));     
        }
    };  

    // login code start
    $scope.savedLogin = localStorage.getItem('loginDB'); 
    $scope.loginDB = (localStorage.getItem('loginDB')!==null) ? JSON.parse($scope.savedLogin) : ""; 
    localStorage.setItem('loginDB', JSON.stringify($scope.loginDB));  

    $scope.komentatorText = $scope.loginDB;

    $scope.addSession = function() {
        console.log($scope.usernameText);
        if($scope.usernameText == "" || $scope.usernameText == null){
            alert('Input nama');
        }else{
            $scope.loginDB = $scope.usernameText; 
            $scope.usernameText = '';  
            $('#closeLogin').trigger('click');
            localStorage.setItem('loginDB', JSON.stringify($scope.loginDB));  
            $scope.komentatorText = $scope.loginDB;
        }
    }; 

    $scope.removeSession = function() {
        // console.log($scope.usernameText);
        $scope.komentatorText = "";        
        $scope.loginDB = "";   
        localStorage.setItem('loginDB', JSON.stringify($scope.loginDB));     
        
    };   
    // login code end
});
$(document).ready(function(){
     $(window).scroll(function () {
            if ($(this).scrollTop() > 50) {
                $('#back-to-top').fadeIn();
            } else {
                $('#back-to-top').fadeOut();
            }
        });
        // scroll body to 0px on click
        $('#back-to-top').click(function () {
            $('#back-to-top').tooltip('hide');
            $('body,html').animate({
                scrollTop: 0
            }, 800);
            return false;
        });
        
        $('#back-to-top').tooltip('show');

});
</script>
</html>